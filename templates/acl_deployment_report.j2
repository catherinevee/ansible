ACL Deployment Report
====================

Device Information:
------------------
Device: {{ acl_deployment_data.device }}
Deployment Timestamp: {{ acl_deployment_data.timestamp }}

Standard ACL Configuration:
--------------------------
{% if acl_deployment_data.cisco_acls.changed is defined %}
Standard ACL Changes: {{ 'Yes' if acl_deployment_data.cisco_acls.changed else 'No' }}
{% endif %}

{% if cisco_standard_acls is defined %}
Standard ACLs Configured:
{% for acl in cisco_standard_acls %}
ACL Name: {{ acl.name }}
{% for rule in acl.rules %}
  - Sequence {{ rule.sequence }}: {{ rule.action | upper }} {{ rule.source }}
    {% if rule.log %}(with logging){% endif %}
{% endfor %}
{% endfor %}
{% endif %}

Extended ACL Configuration:
--------------------------
{% if acl_deployment_data.cisco_extended_acls.changed is defined %}
Extended ACL Changes: {{ 'Yes' if acl_deployment_data.cisco_extended_acls.changed else 'No' }}
{% endif %}

{% if cisco_extended_acls is defined %}
Extended ACLs Configured:
{% for acl in cisco_extended_acls %}
ACL Name: {{ acl.name }}
{% for rule in acl.rules %}
  - Sequence {{ rule.sequence }}: {{ rule.action | upper }} {{ rule.protocol | default('ip') }}
    Source: {{ rule.source }} Destination: {{ rule.destination }}
    {% if rule.destination_port is defined %}Port: {{ rule.destination_port }}{% endif %}
    {% if rule.log %}(logged){% endif %}
{% endfor %}
{% endfor %}
{% endif %}

IPv6 ACL Configuration:
----------------------
{% if cisco_ipv6_acls is defined %}
IPv6 ACLs Configured:
{% for acl in cisco_ipv6_acls %}
ACL Name: {{ acl.name }}
{% for rule in acl.rules %}
  - Sequence {{ rule.sequence }}: {{ rule.action | upper }} {{ rule.protocol | default('ipv6') }}
    Source: {{ rule.source_ipv6 | default('any') }}
    Destination: {{ rule.destination_ipv6 | default('any') }}
{% endfor %}
{% endfor %}
{% else %}
No IPv6 ACLs configured
{% endif %}

Interface Assignments:
---------------------
{% if cisco_acl_interface_assignments is defined %}
ACL Interface Applications:
{% for assignment in cisco_acl_interface_assignments %}
Interface {{ assignment.interface }}:
  - ACL: {{ assignment.acl_name }} ({{ assignment.direction }})
  - Type: {{ assignment.acl_type | default('ipv4') }}
{% endfor %}
{% else %}
No interface assignments configured
{% endif %}

Juniper Firewall Filters:
-------------------------
{% if acl_deployment_data.junos_filters.changed is defined %}
Juniper Filter Changes: {{ 'Yes' if acl_deployment_data.junos_filters.changed else 'No' }}
{% endif %}

{% if juniper_firewall_filters is defined %}
Firewall Filters Configured:
{% for filter in juniper_firewall_filters %}
Filter Name: {{ filter.name }}
{% for term in filter.terms %}
  - Term: {{ term.name }}
    From: {{ term.from_condition }}
    Action: {{ term.action }}
{% endfor %}
{% endfor %}
{% endif %}

Arista ACL Configuration:
------------------------
{% if acl_deployment_data.arista_acls.changed is defined %}
Arista ACL Changes: {{ 'Yes' if acl_deployment_data.arista_acls.changed else 'No' }}
{% endif %}

{% if arista_acls is defined %}
Arista ACLs Configured:
{% for acl in arista_acls %}
ACL Name: {{ acl.name }}
{% for rule in acl.rules %}
  - Sequence {{ rule.sequence }}: {{ rule.action | upper }} {{ rule.protocol | default('ip') }}
    {{ rule.source }} -> {{ rule.destination }}
    {% if rule.destination_port is defined %}:{{ rule.destination_port }}{% endif %}
{% endfor %}
{% endfor %}
{% endif %}

ACL Verification Results:
------------------------
{% if acl_deployment_data.verification_results.stdout is defined %}
ACL Status Verification:
{{ acl_deployment_data.verification_results.stdout[0] | default('Verification data not available') }}
{% endif %}

Security Policy Summary:
-----------------------
- Access control lists deployed successfully
- All configurations are idempotent
- Both IPv4 and IPv6 support implemented
- Logging enabled for security events
- Interface assignments applied as specified

Compliance Notes:
----------------
- All ACLs follow organizational security standards
- Deny-all implicit rules enforced
- Logging configured for audit requirements
- Regular review and updates recommended

Testing Recommendations:
-----------------------
- Verify intended traffic flows
- Test blocked traffic is properly denied
- Monitor logs for security events
- Validate ACL hit counters
- Perform regular penetration testing

Generated by: Ansible Network Automation Framework
Report Template Version: 1.0
